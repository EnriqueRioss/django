{% extends 'layouts/base2.html' %}
{% load static %}

{%block content%}

<!DOCTYPE html>
<html lang="es"> {# Changed lang to es #}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANTECEDENTES PERSONALES | IIG - LUZ</title>
    <link rel="stylesheet" href= "{% static '/styles/stylesforms.css' %}">
</head>
<body> {# Added body tag #}

<div class="form-container">
    <h1>Antecedentes Personales y Desarrollo</h1>
    <p class="historia-info">Historia Clínica #{{ historia.numero_historia }}</p>
    <p class="context-info">
        Para: {{ context_object_name }}
        {% if editing %} (Modo Edición){% endif %}
    </p>
    <br><br>

    <form method="post">
        {% csrf_token %}

        {% if form.non_field_errors %}
            <div class="alert alert-danger non-field-errors">
                {% for error in form.non_field_errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
        {% endif %}

        <div class="form-section">
            <div class="section-header" onclick="toggleSection('prenatales')">
                <h3>1. Antecedentes prenatales y obstetricos</h3>
            </div>
            <div id="prenatales-content" class="section-content">
                <div class="form-group-tres">
                    <div class="third-width">
                        <label for="{{ form.fur.id_for_label }}">FUR (Fecha de Última Regla)</label>
                        {{ form.fur }}
                        {% if form.fur.errors %}<div class="field-errors">{% for e in form.fur.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.controles_prenatales.id_for_label }}">Controles Prenatales</label>
                        {{ form.controles_prenatales }}
                        {% if form.controles_prenatales.errors %}<div class="field-errors">{% for e in form.controles_prenatales.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.edad_gestacional.id_for_label }}">Edad Gestacional</label>
                        {{ form.edad_gestacional }}
                        {% if form.edad_gestacional.errors %}<div class="field-errors">{% for e in form.edad_gestacional.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                </div>
                <div class="form-group-tres">
                    <div class="third-width">
                        <label for="{{ form.numero_partos.id_for_label }}">Número de Partos</label>
                        {{ form.numero_partos }}
                        {% if form.numero_partos.errors %}<div class="field-errors">{% for e in form.numero_partos.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.numero_gestas.id_for_label }}">Número de Gestas</label>
                        {{ form.numero_gestas }}
                        {% if form.numero_gestas.errors %}<div class="field-errors">{% for e in form.numero_gestas.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.numero_cesareas.id_for_label }}">Número de Cesáreas</label>
                        {{ form.numero_cesareas }}
                        {% if form.numero_cesareas.errors %}<div class="field-errors">{% for e in form.numero_cesareas.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                </div>

                <div class="form-group-tres">
                    <div class="third-width">
                        <label for="{{ form.numero_abortos.id_for_label }}">Número de Abortos</label>
                        {{ form.numero_abortos }}
                        {% if form.numero_abortos.errors %}<div class="field-errors">{% for e in form.numero_abortos.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.numero_mortinatos.id_for_label }}">Número de Mortinatos</label>
                        {{ form.numero_mortinatos }}
                        {% if form.numero_mortinatos.errors %}<div class="field-errors">{% for e in form.numero_mortinatos.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.numero_malformaciones.id_for_label }}">Número de Malformaciones</label>
                        {{ form.numero_malformaciones }}
                        {% if form.numero_malformaciones.errors %}<div class="field-errors">{% for e in form.numero_malformaciones.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                </div>
                <div class="form-group">
                    <label for="{{ form.complicaciones_embarazo.id_for_label }}">Complicaciones del Embarazo</label>
                    {{ form.complicaciones_embarazo }}
                    {% if form.complicaciones_embarazo.errors %}<div class="field-errors">{% for e in form.complicaciones_embarazo.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.exposicion_teratogenos.id_for_label }}">Exposición a Teratógenos</label>
                    {{ form.exposicion_teratogenos }}
                    {% if form.exposicion_teratogenos.errors %}<div class="field-errors">{% for e in form.exposicion_teratogenos.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.descripcion_exposicion.id_for_label }}">Descripción de la Exposición</label>
                    {{ form.descripcion_exposicion }}
                    {% if form.descripcion_exposicion.errors %}<div class="field-errors">{% for e in form.descripcion_exposicion.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.enfermedades_maternas.id_for_label }}">Enfermedades Maternas</label>
                    {{ form.enfermedades_maternas }}
                    {% if form.enfermedades_maternas.errors %}<div class="field-errors">{% for e in form.enfermedades_maternas.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.complicaciones_parto.id_for_label }}">Complicaciones del Parto</label>
                    {{ form.complicaciones_parto }}
                    {% if form.complicaciones_parto.errors %}<div class="field-errors">{% for e in form.complicaciones_parto.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.otros_antecedentes.id_for_label }}">Otros Antecedentes</label>
                    {{ form.otros_antecedentes }}
                    {% if form.otros_antecedentes.errors %}<div class="field-errors">{% for e in form.otros_antecedentes.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.observaciones.id_for_label }}">Observaciones</label>
                    {{ form.observaciones }}
                    {% if form.observaciones.errors %}<div class="field-errors">{% for e in form.observaciones.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
            </div>
        </div>

        <div class="form-section">
            <div class="section-header" onclick="toggleSection('neonatal')">
                <h3>2. Periodo Neonatal</h3>
            </div>
            <div id="neonatal-content" class="section-content">
                <div class="form-group-tres">
                    <div class="third-width">
                        <label for="{{ form.peso_nacer.id_for_label }}">Peso al Nacer (kg)</label>
                        {{ form.peso_nacer }}
                        {% if form.peso_nacer.errors %}<div class="field-errors">{% for e in form.peso_nacer.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.talla_nacer.id_for_label }}">Talla al Nacer (cm)</label>
                        {{ form.talla_nacer }}
                        {% if form.talla_nacer.errors %}<div class="field-errors">{% for e in form.talla_nacer.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.circunferencia_cefalica.id_for_label }}">Circunferencia Cefálica (cm)</label>
                        {{ form.circunferencia_cefalica }}
                        {% if form.circunferencia_cefalica.errors %}<div class="field-errors">{% for e in form.circunferencia_cefalica.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                </div>
                <div class="form-group">
                    <h3>Complicaciones</h3><br><br>
                </div>

                <div class="form-group-tres">
                    <div class="third-width">
                        <label for="{{ form.cianosis.id_for_label }}">Cianosis</label>
                        {{ form.cianosis }}
                        {% if form.cianosis.errors %}<div class="field-errors">{% for e in form.cianosis.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.ictericia.id_for_label }}">Ictericia</label>
                        {{ form.ictericia }}
                        {% if form.ictericia.errors %}<div class="field-errors">{% for e in form.ictericia.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.hemorragia.id_for_label }}">Hemorragia</label>
                        {{ form.hemorragia }}
                        {% if form.hemorragia.errors %}<div class="field-errors">{% for e in form.hemorragia.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                </div>
                <div class="form-group-tres">
                    <div class="third-width">
                        <label for="{{ form.infecciones.id_for_label }}">Infecciones</label>
                        {{ form.infecciones }}
                        {% if form.infecciones.errors %}<div class="field-errors">{% for e in form.infecciones.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.convulsiones.id_for_label }}">Convulsiones</label>
                        {{ form.convulsiones }}
                        {% if form.convulsiones.errors %}<div class="field-errors">{% for e in form.convulsiones.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                    <div class="third-width">
                        <label for="{{ form.vomitos.id_for_label }}">Vómitos</label>
                        {{ form.vomitos }}
                        {% if form.vomitos.errors %}<div class="field-errors">{% for e in form.vomitos.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                    </div>
                </div>

                <div class="form-group">
                    <label for="{{ form.observacion_complicaciones.id_for_label }}">Observaciones de Complicaciones</label>
                    {{ form.observacion_complicaciones }}
                    {% if form.observacion_complicaciones.errors %}<div class="field-errors">{% for e in form.observacion_complicaciones.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.otros_complicaciones.id_for_label }}">Otras Complicaciones</label>
                    {{ form.otros_complicaciones }}
                    {% if form.otros_complicaciones.errors %}<div class="field-errors">{% for e in form.otros_complicaciones.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
            </div>
        </div>

        <div class="form-section">
            <div class="section-header" onclick="toggleSection('alimentacion')">
                <h3>3. Alimentación y Evolución</h3>
            </div>
            <div id="alimentacion-content" class="section-content">
                <div class="form-group">
                    <label for="{{ form.tipo_alimentacion.id_for_label }}">Tipo de Alimentación</label>
                    {{ form.tipo_alimentacion }}
                    {% if form.tipo_alimentacion.errors %}<div class="field-errors">{% for e in form.tipo_alimentacion.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.observaciones_alimentacion.id_for_label }}">Observaciones de Alimentación</label>
                    {{ form.observaciones_alimentacion }}
                    {% if form.observaciones_alimentacion.errors %}<div class="field-errors">{% for e in form.observaciones_alimentacion.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.evolucion.id_for_label }}">Evolución</label>
                    {{ form.evolucion }}
                    {% if form.evolucion.errors %}<div class="field-errors">{% for e in form.evolucion.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
            </div>
        </div>

        <div class="form-section">
            <div class="section-header"  onclick="toggleSection('psicomotor')">
                <h3>4. Desarrollo Psicomotor</h3>
            </div>
            <div id="psicomotor-content" class="section-content">
                <div class="form-group">
                    <table class="table-container">
                        <thead>
                            <tr>
                                <th>Desarrollo Psicomotor</th>
                                <th>VH (Valor Habitual)</th>
                                <th>PCTE</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Sostener Cabeza</td>
                                <td>1er Mes</td>
                                <td>{{ form.sostener_cabeza }}{% if form.sostener_cabeza.errors %}<div class="field-errors">{% for e in form.sostener_cabeza.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}</td>
                            </tr>
                            <tr>
                                <td>Sonrisa Social</td>
                                <td>2do Mes</td>
                                <td>{{ form.sonrisa_social }}{% if form.sonrisa_social.errors %}<div class="field-errors">{% for e in form.sonrisa_social.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}</td>
                            </tr>
                            <tr>
                                <td>Sentarse</td>
                                <td>6to Mes</td>
                                <td>{{ form.sentarse }}{% if form.sentarse.errors %}<div class="field-errors">{% for e in form.sentarse.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}</td>
                            </tr>
                            <tr>
                                <td>Gatear</td>
                                <td>9no Mes</td>
                                <td>{{ form.gatear }}{% if form.gatear.errors %}<div class="field-errors">{% for e in form.gatear.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}</td>
                            </tr>
                            <tr>
                                <td>Pararse</td>
                                <td>11vo Mes</td>
                                <td>{{ form.pararse }}{% if form.pararse.errors %}<div class="field-errors">{% for e in form.pararse.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}</td>
                           </tr>
                            <tr>
                                <td>Caminar</td>
                                <td>12vo Mes</td>
                                <td>{{ form.caminar }}{% if form.caminar.errors %}<div class="field-errors">{% for e in form.caminar.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}</td>
                            </tr>
                            <tr>
                                <td>Primeras Palabras</td>
                                <td>12vo Mes</td>
                                <td>{{ form.primeras_palabras }}{% if form.primeras_palabras.errors %}<div class="field-errors">{% for e in form.primeras_palabras.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}</td>
                            </tr>
                            <tr>
                                <td>Primeros Dientes</td>
                                <td>6to Mes</td>
                                <td>{{ form.primeros_dientes }}{% if form.primeros_dientes.errors %}<div class="field-errors">{% for e in form.primeros_dientes.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="form-group">
                    <label for="{{ form.progreso_escuela.id_for_label }}">Progreso en la Escuela</label>
                    {{ form.progreso_escuela }}
                    {% if form.progreso_escuela.errors %}<div class="field-errors">{% for e in form.progreso_escuela.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.progreso_peso.id_for_label }}">Progreso en Peso</label>
                    {{ form.progreso_peso }}
                    {% if form.progreso_peso.errors %}<div class="field-errors">{% for e in form.progreso_peso.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.progreso_talla.id_for_label }}">Progreso en Talla</label>
                    {{ form.progreso_talla }}
                    {% if form.progreso_talla.errors %}<div class="field-errors">{% for e in form.progreso_talla.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.observaciones_habitos_psicologicos.id_for_label }}">Observaciones de Habitos Psicologicos</label>
                    {{ form.observaciones_habitos_psicologicos }}
                    {% if form.observaciones_habitos_psicologicos.errors %}<div class="field-errors">{% for e in form.observaciones_habitos_psicologicos.errors %}<span>{{e}}</span>{% endfor %}</div>{% endif %}
                </div>
            </div>
        </div><br><br>

        <div class="form-actions">
            <button type="submit">Siguiente</button>
        </div>
    </form>
</div>
</body> {# Added closing body tag #}
<script src="https://kit.fontawesome.com/8058dee255.js" crossorigin="anonymous"></script>

<script>
    let openSection = 'prenatales'; // Default open section

    function toggleSection(sectionId) {
        const content = document.getElementById(`${sectionId}-content`);
        // const header = document.querySelector(`[onclick="toggleSection('${sectionId}')"]`); // Not used for styling active

        // Close currently open section if it's not the one being clicked
        if (openSection && openSection !== sectionId) {
            const currentContent = document.getElementById(`${openSection}-content`);
            if (currentContent) currentContent.classList.remove('active');
        }

        // Toggle the clicked section
        if (content) {
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                openSection = null; // No section is actively open
            } else {
                content.classList.add('active');
                openSection = sectionId;
            }
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Initialize the first section to be open
        const initialSectionContent = document.getElementById(`${openSection}-content`);
        if (initialSectionContent) {
            initialSectionContent.classList.add('active');
        }
    });
</script>

{% endblock %}